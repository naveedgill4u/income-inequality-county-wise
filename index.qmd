---
title: "income inequality"
author: Naveed Ahmad
execute: 
  echo: false
---

## Summary
<div style="text-align: justify;"> United Nation has set through SDG 10 to minimize gap of income inequality among people for sustainable development. Income inequality is burning issue for all nations around the glob. In this document, I have explained a picture of income inequality in U.S by using data from American Community Servey (ACS) 2020. Gini Index table has the data of income inequality.
Income Inequality (gini) has link with many social indicators however, in this study, outcome variable is gini with covariates; income, poverty, education rate and umemployment rate in U.S. First, EDA was conducted. Then, liner regression model was used to predict the income inequlaity as function of income, poverty, education rate, and unemployment rate.</div>

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(tidycensus)
library(dplyr)
library(GGally)
library(ggplot2)
library(ggthemes)
library(tidymodels)
library(car)
```

```{r}
#| warning: false
multi_vars <- c(
  gini = "B19083_001",
  median_income = "B19013_001",
  poverty = "B17001_002",                    # Below poverty
  education_total = "B15003_001",           # Total population 25+
  education_bachelor = "B15003_022",        # Bachelor's degree
  labor_force = "B23025_003",               # Labor force
  unemployed = "B23025_005")                # Unemployed

socio_data <- get_acs(
  geography = "county",
  variables = multi_vars,
  year = 2020,
  survey = "acs5",
  output = "wide")

# Clean and calculate additional metrics
socio_clean <- socio_data |>
  transmute(
    county = NAME,
    gini = giniE,
    median_income = median_incomeE,
    poverty = povertyE,
    education_rate = education_bachelorE / education_totalE * 100,
    unemployment_rate = unemployedE / labor_forceE * 100)

```

## 1. Explanatory Data Analysis
<div style="text-align: justify;">Increse in Education and Income had reduced income inequality whereas, increse in unemployment and poverty had incresed income inequality. The relationship among income inequality (gini) and other social indicators can be seen in plot. Log of income and poverty were taken for better comparision purpose. Further, Histograms of every indicator can also be seen in dignal which shows that distributions of gini, log income, log poverty are normal but distributions of education rate and unemployment rate are slightly and significantly right skewed respectively.</div>


```{r}
#| warning: false
plot_data <- socio_clean |>
  mutate(
    log_income = log(median_income),
    log_poverty = log(poverty + 1)) |>
  select(
    Gini = gini,
    `Log Income` = log_income,
    `Log Poverty` = log_poverty,
    `Education Rate (%)` = education_rate,
    `Unemployment Rate (%)` = unemployment_rate)

# Plot
ggpairs(
  plot_data,
  lower = list(continuous = function(data, mapping, ...) {
    ggplot(data = data, mapping = mapping) +
      geom_point(alpha = 0.6, color = "skyblue") +
      geom_smooth(method = "loess", se = FALSE, color = "red", linetype = "dashed", size = 0.5)}),
  upper = list(continuous = wrap("cor", size = 3)),
  diag = list(continuous = wrap("densityDiag", alpha = 0.4, fill = "#69b3a2"))) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 12, color = "gray30"),
    plot.caption = element_text(size = 10, color = "gray40"),
    strip.text.y = element_text(angle = 0, hjust = 1))  +
  labs(
    title = "Income Inequality with other Indicators in U.S",
    subtitle = "Education and Income have negative But Povery and Unemployment have positive relationship with Income Inequality",
    caption = "Source: American Community Survey (ACS) 2020")
```

## 2.  Model
<div style="text-align: justify;">Since my outcome variable was continues therfore, Liner Regression Model was applied. Following is the general form of a linear regression model.</div>

$$
Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \cdots + \beta_p X_{pi} + \varepsilon_i
$$


```{r}
socio_clean1 <- socio_clean |>
  select(gini, median_income ,poverty, education_rate, unemployment_rate )
```

```{r}
income_inequality <- linear_reg() |> 
   fit(gini ~ median_income + poverty + education_rate, data = socio_clean1)
```

```{r}
income_inequality |> 
  tidy(conf.int = TRUE)
```

# Data Generating Mechanism
$$
\hat{\text{Gini}} = 0.472 
- 1.35 \times 10^{-6} \cdot \text{MedianIncome} 
+ 1.42 \times 10^{-7} \cdot \text{Poverty} 
+ 0.00217 \cdot \text{EducationRate} 
+ 0.00249 \cdot \text{UnemploymentRate}
$$


